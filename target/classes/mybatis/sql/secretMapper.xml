<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="secretMapper">

  <!-- 글 등록 -->
  <insert id="create" parameterType="net.koreate.hellking.board.vo.SecretBoardVO">
    INSERT INTO secret_board (bno, title, content, nickname, password, regdate, viewcnt, agree)
    VALUES (secret_board_seq.NEXTVAL, #{title}, #{content}, #{nickname}, #{password}, DEFAULT, DEFAULT, DEFAULT)
  </insert>

  <!-- 목록 -->
  <select id="listCriteria"
          parameterType="net.koreate.hellking.board.util.BoardCriteria"
          resultType="net.koreate.hellking.board.vo.SecretBoardVO">
    SELECT *
    FROM secret_board
    ORDER BY bno DESC
    OFFSET #{startRow} ROWS FETCH NEXT #{perPageNum} ROWS ONLY
  </select>

  <select id="totalCount" resultType="int">
    SELECT COUNT(*) FROM secret_board
  </select>

  <select id="read" parameterType="int"
          resultType="net.koreate.hellking.board.vo.SecretBoardVO">
    SELECT * FROM secret_board WHERE bno = #{bno}
  </select>

  <update id="updateCnt" parameterType="int">
    UPDATE secret_board SET viewcnt = viewcnt + 1 WHERE bno = #{bno}
  </update>

  <update id="update" parameterType="net.koreate.hellking.board.vo.SecretBoardVO">
    UPDATE secret_board
    SET title = #{title},
        content = #{content},
        nickname = #{nickname}
    WHERE bno = #{bno}
  </update>

  <delete id="delete" parameterType="int">
    DELETE FROM secret_board WHERE bno = #{bno}
  </delete>

  <select id="getPassword" parameterType="int" resultType="string">
    SELECT password FROM secret_board WHERE bno = #{bno}
  </select>

  <update id="updateAgree" parameterType="int">
    UPDATE secret_board SET agree = agree + 1 WHERE bno = #{bno}
  </update>

  <select id="viewAgree" parameterType="int" resultType="int">
    SELECT agree FROM secret_board WHERE bno = #{bno}
  </select>

</mapper>
